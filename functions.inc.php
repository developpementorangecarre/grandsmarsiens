<?phpfunction ouvre_page($page){	printf("		<script language=\"JavaScript\">			document.location.replace(\"%s\");			</script>",$page);}function echo_toto(){	echo "TOTO include fonction <br>";}function db_connect($host,$db,$username,$password){	$mysql_link = mysql_connect($host,$username,$password);	mysql_select_db($db, $mysql_link);	return $mysql_link;}function exec_sql($sql,$connection){	$res = mysql_query($sql, $connection);	return $res;}function fetch_row($sql = 0){if (!$sql):	return 0;endif;if ($sql):	$row[$sql]=@mysql_fetch_array($sql);	return $row[$sql];else:	return false;endif;} function text2sql($texte,$slash=1){	if ($slash==1):		$format_text=str_replace("<","&lt;",$texte);		$format_text=str_replace(">","&gt;",$format_text);		return addslashes($format_text);	else:		$format_text=str_replace("<","&lt;",$texte);		$format_text=str_replace(">","&gt;",$format_text);		return $format_text;	endif;}function text2js($texte,$slash=1){	if ($slash==1):		$format_text=str_replace("<","&lt;",$texte);		$format_text=str_replace(">","&gt;",$format_text);		$format_text=str_replace("'"," ",$format_text);		return addslashes($format_text);	else:		$format_text=str_replace("<","&lt;",$texte);		$format_text=str_replace(">","&gt;",$format_text);		return $format_text;	endif;}function tab_vente($connection){$bgcolor="#FFFFBB"; $lastmonth = mktime(0, 0, 0, date("m")-1, date("d"),   date("Y"));$mysqllastmonth = date( 'Y-m-d H:i:s', $lastmonth );$nextmonth = mktime(0, 0, 0, date("m")+1, date("d"),   date("Y"));$mysqlnextmonth = date( 'Y-m-d H:i:s', $nextmonth );echo "<table class=sample> <tr bgcolor=#FFFFFF> <td><b> Etat </b></td> <td><b> Nombre </b></td> <td><b> prix </b></td> <td><b> net vendeur </b></td> </tr>"; $query="select count(a.id) as compte,e.etat as etat, sum(a.prix) as prix,sum(a.prix_vendeur) as prix_vendeur 			from pm_articles as a, pm_etat_articles as e , pm_ventes as v			where e.id=a.etat and a.etat=2 and v.date > '$mysqllastmonth' and v.id=a.vente and  v.date < '$mysqlnextmonth'			group by a.etat"; 			//		echo $query;$result=exec_sql($query,$connection); while ($ligne=fetch_row($result)) 	{ 	$compte=$ligne['compte']; 	$etat=$ligne['etat']; 	$prix=$ligne['prix']; 	$prix_vendeur=$ligne['prix_vendeur']; 	echo "<tr bgcolor=$bgcolor> <td> $etat </td> <td> $compte </td> <td> $prix &#8364;</td> <td> $prix_vendeur &#8364; </td> </tr>"; 	$counter++; 	if (($counter%2) == 0): 		$bgcolor="#FFFFBB"; 		else: $bgcolor="#FFFFFF"; 	endif; } 	$query="select sum(prix),sum(prix_vendeur) from pm_articles "; 	$result=exec_sql($query,$connection); 	/*	while ($ligne=fetch_row($result)) 	{ 		echo "<tr> <td colspan=2> TOTAL </td> <td> $ligne[0] &#8364;</td> 			<td> $ligne[1] &#8364;</td> </tr>"; 	} */	echo "</table>"; }function tab_stock($connection){$bgcolor="#FFFFBB"; echo "<table class=sample> <tr bgcolor=#FFFFFF> <td><b> Etat </b></td> <td><b> Nombre </b></td> <td><b> prix </b></td> <td><b> net vendeur </b></td> </tr>"; $query="select count(a.id) as compte,e.etat as etat, sum(a.prix) as prix,sum(a.prix_vendeur) as prix_vendeur from pm_articles as a, pm_etat_articles as e where e.id=a.etat and a.etat=1 group by a.etat"; $result=exec_sql($query,$connection); while ($ligne=fetch_row($result)) 	{ 	$compte=$ligne['compte']; 	$etat=$ligne['etat']; 	$prix=$ligne['prix']; 	$prix_vendeur=$ligne['prix_vendeur']; 	echo "<tr bgcolor=$bgcolor> <td> $etat </td> <td> $compte </td> <td> $prix &#8364;</td> <td> $prix_vendeur &#8364; </td> </tr>"; 	$counter++; 	if (($counter%2) == 0): 		$bgcolor="#FFFFBB"; 		else: $bgcolor="#FFFFFF"; 	endif; } 	$query="select sum(prix),sum(prix_vendeur) from pm_articles "; 	$result=exec_sql($query,$connection); 	/*	while ($ligne=fetch_row($result)) 	{ 		echo "<tr> <td colspan=2> TOTAL </td> <td> $ligne[0] &#8364;</td> 			<td> $ligne[1] &#8364;</td> </tr>"; 	} */	echo "</table>"; }function tab_stock_par_taille($connection){$bgcolor="#FFFFBB"; echo "<table class=sample> <tr bgcolor=#FFFFFF> <td><b> Taille </b></td> <td><b> Nombre </b></td> </tr>"; $query="select count(*) as compte ,pm_tailles.taille  as taille		from pm_articles,pm_tailles 		where pm_articles.etat=1 				and pm_articles.type=1 				and pm_articles.taille=pm_tailles.id 				group by pm_tailles.id;"; $result=exec_sql($query,$connection); while ($ligne=fetch_row($result)) 	{ 	$compte=$ligne['compte']; 	$taille=$ligne['taille']; 	echo "<tr bgcolor=$bgcolor> <td> $taille </td> <td> $compte </td>  </tr>"; 	$counter++; 	if (($counter%2) == 0): 		$bgcolor="#FFFFBB"; 		else: $bgcolor="#FFFFFF"; 	endif; } 		echo "</table>"; }echo "<script language=\"Javascript\"><!--function toggleDiv(id,flagit) {if (flagit==\"1\"){if (document.layers) document.layers[''+id+''].visibility = \"show\"else if (document.all) document.all[''+id+''].style.visibility = \"visible\"else if (document.getElementById) document.getElementById(''+id+'').style.visibility = \"visible\"}elseif (flagit==\"0\"){if (document.layers) document.layers[''+id+''].visibility = \"hide\"else if (document.all) document.all[''+id+''].style.visibility = \"hidden\"else if (document.getElementById) document.getElementById(''+id+'').style.visibility = \"hidden\"}}//--></script>";function tab_stock_par_taille_type($connection){$bgcolor="#FFFFBB"; echo "<table class=sample> <tr bgcolor=#FFFFFF> <td><b> Taille </b></td> ";$query="select image as image from pm_types "; $result=exec_sql($query,$connection); while ($ligne=fetch_row($result)) 	{ 		$image=$ligne['image']; 		echo "<td><img src=$image> </td>";	}								echo " <td>total</td></tr>"; $query="select count(*) as compte ,pm_tailles.taille as taille, pm_articles.taille as tailleid		from pm_articles,pm_tailles 		where pm_articles.etat=1 				and pm_articles.taille=pm_tailles.id 				group by pm_tailles.id;"; $result=exec_sql($query,$connection); while ($ligne=fetch_row($result)) 	{ 	$compte=$ligne['compte']; 	$taille=$ligne['taille']; 	$tailleid=$ligne['tailleid']; 	echo "<tr bgcolor=$bgcolor> <td> $taille </td>";		/****boucle sur types ****/	$querytype="select id as type from pm_types "; 	$resulttype=exec_sql($querytype,$connection); 	while ($lignetype=fetch_row($resulttype)) 	{ 		$type=$lignetype['type'];		/************ boucle comptage par type**********/		$querysubtotal="select count(*) as compte		from pm_articles 		where pm_articles.etat=1 				and pm_articles.type=$type				and pm_articles.taille=$tailleid ";		$resultsubtotal=exec_sql($querysubtotal,$connection); 		while ($lignesubtotal=fetch_row($resultsubtotal)) 			{			$subtotal=$lignesubtotal['compte'];			echo "<td>$subtotal </td>";			}					}			echo "<td> $compte </td>  </tr>"; 	$counter++; 	if (($counter%2) == 0): 		$bgcolor="#FFFFBB"; 		else: $bgcolor="#FFFFFF"; 	endif; } 				echo "</table>"; }function creer_liste($vendeur,$bourse,$connection){	$code=0;						while ($ligne=fetch_row($result_bourse))			{				$bourse=$ligne[0];			}						$query_code="select max(code) from pm_liste_articles where bourse='$bourse'";			$result_code=exec_sql($query_code,$connection);			while ($ligne=fetch_row($result_code))			{				$code=$ligne[0] + 1;			}												$query="insert into pm_liste_articles values(NULL,$vendeur,0,'$bourse',$code) ";			$result=exec_sql($query,$connection);						echo "$query";						$query="select id from pm_liste_articles where vendeur=$vendeur ";			$result=exec_sql($query,$connection);			while ($ligne=fetch_row($result))			{				$liste=$ligne[0];			}			return $liste;}function codeetbourse2liste($code,$bourse,$connection){			$query="select id from pm_liste_articles where code=$code and bourse='$bourse'";			$result=exec_sql($query,$connection);			while ($ligne=fetch_row($result))			{				$liste=$ligne[0];			}			return $liste;}function code2liste($code,$connection){			$query_bourse="select id from pm_bourses where statut=1";			$result_bourse=exec_sql($query_bourse,$connection);						while ($ligne=fetch_row($result_bourse))			{				$bourse=$ligne[0];			}			$query="select id from pm_liste_articles where code=$code and bourse='$bourse'";			$result=exec_sql($query,$connection);			while ($ligne=fetch_row($result))			{				$liste=$ligne[0];			}			return $liste;			}function liste2code($liste,$connection){		$query="select bourse,code from pm_liste_articles where id=$liste";		$result=exec_sql($query,$connection);		while ($ligne=fetch_row($result))		{				$code=$ligne[1];		}			return $code;			}function liste2bourse($liste,$connection){		$query="select bourse,code from pm_liste_articles where id=$liste";		$result=exec_sql($query,$connection);		while ($ligne=fetch_row($result))		{				$bourse=$ligne[0];		}			return $bourse;			}function getbourse($connection){		$query_bourse="select id from pm_bourses where statut=1";		$result_bourse=exec_sql($query_bourse,$connection);			while ($ligne=fetch_row($result_bourse))			{				$bourse=$ligne[0];			}					return $bourse;}function getval($parametre,$connection){		$query="select valeur from pm_parametres where parametre='$parametre'";		$result=exec_sql($query,$connection);			while ($ligne=fetch_row($result))			{				$valeur=$ligne['valeur'];			}		return $valeur;}?>